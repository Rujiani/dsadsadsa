# Эксперимент: Определение оптимального размера скрытого слоя

## Описание

Скрипт `experiment_hidden_layer.m` автоматически тестирует различные размеры скрытого слоя нейронной сети и определяет оптимальное количество нейронов для задачи классификации рукописных цифр.

## Запуск

1. Убедитесь, что вы находитесь в директории `mlclass-ex4`
2. Запустите скрипт в Octave:
   ```matlab
   experiment_hidden_layer
   ```

## Что делает скрипт

1. **Загружает данные** из `ex4data1.mat`
2. **Разделяет данные** на обучающую (80%) и валидационную (20%) выборки
3. **Тестирует различные размеры** скрытого слоя: [5, 10, 15, 20, 25, 30, 40, 50]
4. **Обучает нейронную сеть** для каждого размера
5. **Вычисляет точность** на обучающей и валидационной выборках
6. **Находит оптимальный размер** (максимальная точность на валидации)
7. **Создает график** зависимости точности от размера
8. **Сохраняет результаты** в файл `results_hidden_layer.txt`

## Параметры эксперимента

Вы можете изменить следующие параметры в начале скрипта:

```matlab
hidden_layer_sizes = [5, 10, 15, 20, 25, 30, 40, 50];  % Тестируемые размеры
lambda = 1;              % Параметр регуляризации
max_iter = 50;           % Количество итераций обучения
```

## Результаты

После выполнения вы получите:

1. **Таблицу результатов** в консоли с точностью для каждого размера
2. **График** зависимости точности от размера скрытого слоя
3. **Файл** `results_hidden_layer.txt` с детальными результатами
4. **Оптимальный размер** скрытого слоя

## Интерпретация результатов

- **Точность на обучающей выборке**: показывает, насколько хорошо модель запомнила данные
- **Точность на валидационной выборке**: показывает обобщающую способность модели (главная метрика)
- **Оптимальный размер**: размер с максимальной точностью на валидации

### Признаки переобучения:
- Большая разница между точностью на обучении и валидации
- Высокая точность на обучении, но низкая на валидации

### Признаки недообучения:
- Низкая точность на обеих выборках
- Малая разница между точностью на обучении и валидации, но обе низкие

## Время выполнения

Для 5000 примеров и 50 итераций каждый эксперимент занимает примерно 2-5 минут. 
Общее время для всех 8 размеров: около 20-40 минут.

## Требования

- Octave или MATLAB
- Все функции из задания должны быть реализованы:
  - `sigmoidGradient.m`
  - `randInitializeWeights.m`
  - `nnCostFunction.m`
  - `predict.m`
- Файл данных `ex4data1.mat` должен находиться в той же директории

## Пример вывода

```
========================================
РЕЗУЛЬТАТЫ ЭКСПЕРИМЕНТОВ
========================================
Скрытый   Точность (обучение) Точность (валидация)   Стоимость    
--------------------------------------------------------
5         75.23               74.15                   0.523456
10        85.67               84.32                   0.412345
...
25        95.12               94.56                   0.287629
...

========================================
ОПТИМАЛЬНЫЙ РАЗМЕР СКРЫТОГО СЛОЯ
========================================
Оптимальное количество нейронов: 25
Точность на валидационной выборке: 94.56%
Точность на обучающей выборке: 95.12%
```

