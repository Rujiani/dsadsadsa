source("~/studDir/DS_R/lab5/lab5_association_rules.R")
source("~/studDir/DS_R/lab5/lab5_association_rules.R")
source("~/studDir/DS_R/lab5/lab5_association_rules.R")
source("~/studDir/DS_R/lab5/lab5_association_rules.R")
source("~/studDir/DS_R/lab5/lab5_association_rules.R")
source("~/studDir/DS_R/lab5/lab5_association_rules.R")
source("~/studDir/DS_R/lab5/lab5_association_rules.R")
source("~/studDir/DS_R/lab5/lab5_association_rules.R")
source("~/studDir/DS_R/lab5/lab5_association_rules.R")
source("~/studDir/DS_R/lab5/lab5_association_rules.R")
source("~/studDir/DS_R/lab5/lab5_association_rules.R")
source("~/studDir/DS_R/lab5/lab5_association_rules.R")
# Create custom 2D color palette function
col_palette <- colorRampPalette(c("#313695", "#4575B4", "#74ADD1", "#ABD9E9",
"#E0F3F8", "#FFFFBF", "#FEE090", "#FDAE61",
"#F46D43", "#D73027", "#A50026"))
plot(high_conf_rules, method = "matrix",
measure = c("lift", "confidence"),
reorder = "none",
control = list(col = col_palette(100)))
png("matrix_confidence_lift.png", width = 1000, height = 800)
plot(high_conf_rules, method = "matrix",
measure = c("lift", "confidence"),
reorder = "none",
control = list(col = col_palette(100)))
dev.off()
# n. Extract 3 rules with highest lift from ALL rules (not just confidence > 0.8)
top3_lift_all <- head(sort(rules_0conf, by = "lift", decreasing = TRUE), 3)
inspect(top3_lift_all)
# Compare with top 3 from high confidence rules
top3_lift_highconf <- head(sort(high_conf_rules, by = "lift", decreasing = TRUE), 3)
inspect(top3_lift_highconf)
# o. Extract THREE rules with highest lift for graph visualization
top3_rules_graph <- head(sort(rules_0conf, by = "lift", decreasing = TRUE), 3)
inspect(top3_rules_graph)
# Graph-based visualization with items and rules as vertices
plot(top3_rules_graph, method = "graph", engine = "igraph")
png("graph_rules.png", width = 1000, height = 800)
plot(top3_rules_graph, method = "graph", engine = "igraph")
dev.off()
# Split transactions: first 8000 for training, last 2000 for testing
train_trans <- trans[1:8000]
test_trans <- trans[8001:10000]
# Mine rules on training set
rules_train <- apriori(train_trans, parameter = list(
support = 0.01,
confidence = 0.5,
minlen = 2
), control = list(verbose = FALSE))
# Mine rules on test set
rules_test <- apriori(test_trans, parameter = list(
support = 0.01,
confidence = 0.5,
minlen = 2
), control = list(verbose = FALSE))
# Compare results
comparison <- data.frame(
Dataset = c("Full (10000)", "Training (8000)", "Testing (2000)"),
Rules_Count = c(length(rules_50conf), length(rules_train), length(rules_test)),
Avg_Support = c(
mean(quality(rules_50conf)$support),
mean(quality(rules_train)$support),
mean(quality(rules_test)$support)
),
Avg_Confidence = c(
mean(quality(rules_50conf)$confidence),
mean(quality(rules_train)$confidence),
mean(quality(rules_test)$confidence)
),
Avg_Lift = c(
mean(quality(rules_50conf)$lift),
mean(quality(rules_train)$lift),
mean(quality(rules_test)$lift)
)
)
comparison
# Common rules analysis
train_rules_df <- as(rules_train, "data.frame")
test_rules_df <- as(rules_test, "data.frame")
# Find overlapping rules (q. Justify relationships are not artifacts)
common_rules <- intersect(train_rules_df$rules, test_rules_df$rules)
length(common_rules)
# Percentage overlap
overlap_pct <- length(common_rules) / length(rules_train) * 100
overlap_pct
# Show some common rules
common_idx <- which(train_rules_df$rules %in% common_rules)
head(train_rules_df[common_idx, ], 10)
# j. Rules appearing in at least 10% of transactions (support >= 0.1) - 3 rules
rules_10pct <- subset(rules_0conf, support >= 0.1)
inspect(rules_10pct)
# Interactive scatter plot to identify rules (for question j)
# Use plotly_arules for interactive exploration if available
plot(rules_0conf, method = "scatterplot", measure = c("support", "confidence"),
shading = "lift", main = "Interactive Scatter Plot")
png("scatter_interactive.png", width = 1000, height = 700)
plot(rules_0conf, method = "scatterplot", measure = c("support", "confidence"),
shading = "lift", main = "Scatter Plot for Rule Identification")
dev.off()
# l. Four interesting rules from matrix (highest lift with high confidence)
four_interesting <- head(sort(high_conf_rules, by = "lift", decreasing = TRUE), 4)
inspect(four_interesting)
# m. Rules with dark blue color (low lift, close to 1)
low_lift_rules <- subset(high_conf_rules, lift < 3)
inspect(head(sort(low_lift_rules, by = "lift"), 10))
# Save summary statistics
sink("analysis_results.txt")
cat("=== ASSOCIATION RULES ANALYSIS RESULTS ===\n\n")
cat("BASIC STATISTICS:\n")
cat("-----------------\n")
cat("Total transactions:", length(trans), "\n")
cat("Total items:", length(itemLabels(trans)), "\n")
cat("Average transaction size:", round(mean(trans_sizes), 2), "\n")
cat("Max transaction size (b):", max_size, "\n\n")
cat("a. MOST FREQUENT ITEM:\n")
cat("----------------------\n")
print(most_frequent)
cat("\n")
cat("TOP 10 FREQUENT ITEMS:\n")
cat("----------------------\n")
print(head(item_freq_df, 10))
cat("\n")
cat("c. RULES WITH 0% CONFIDENCE:\n")
cat("----------------------------\n")
cat("Number of rules:", length(rules_0conf), "\n\n")
cat("d. RULES WITH 50% CONFIDENCE:\n")
cat("-----------------------------\n")
cat("Number of rules:", length(rules_50conf), "\n\n")
cat("e. RULES COUNT BY CONFIDENCE:\n")
cat("-----------------------------\n")
print(rules_stats)
cat("\n")
cat("HIGH CONFIDENCE RULES (>0.8):\n")
# Association Rules Analysis - Lab 5
# Required packages
if (!require("arules")) install.packages("arules", repos = "https://cloud.r-project.org")
# Association Rules Analysis - Lab 5
# Association Rules Analysis - Lab 5
# Association Rules Analysis - Lab 5
# Association Rules Analysis - Lab 5
# Association Rules Analysis - Lab 5
# Association Rules Analysis - Lab 5
# Association Rules Analysis - Lab 5
# Association Rules Analysis - Lab 5
# Association Rules Analysis - Lab 5
# Association Rules Analysis - Lab 5
# Association Rules Analysis - Lab 5
# Association Rules Analysis - Lab 5
# Association Rules Analysis - Lab 5
# Association Rules Analysis - Lab 5
# Association Rules Analysis - Lab 5
# Association Rules Analysis - Lab 5
# Required packages
if (!require("arules")) install.packages("arules", repos = "https://cloud.r-project.org")
if (!require("arulesViz")) install.packages("arulesViz", repos = "https://cloud.r-project.org")
if (!require("igraph")) install.packages("igraph", repos = "https://cloud.r-project.org")
library(arules)
library(arulesViz)
library(igraph)
setwd("~/studDir/DS_R/lab5/")
# Import transaction data
trans <- read.transactions("AssociationRules.csv", format = "basket", sep = " ")
# Basic info about transactions
summary(trans)
# Frequent item plot
itemFrequencyPlot(trans, topN = 20, type = "absolute",
main = "Top 20 Most Frequent Items",
col = "steelblue", horiz = TRUE)
png("frequent_items_plot.png", width = 1200, height = 600)
itemFrequencyPlot(trans, topN = 20, type = "absolute",
main = "Top 20 Most Frequent Items",
col = "steelblue", horiz = TRUE)
dev.off()
# Frequent item table
item_freq <- itemFrequency(trans, type = "absolute")
item_freq_df <- data.frame(
Item = names(item_freq),
Frequency = as.numeric(item_freq),
Support = as.numeric(itemFrequency(trans, type = "relative"))
)
item_freq_df <- item_freq_df[order(-item_freq_df$Frequency), ]
head(item_freq_df, 20)
# a. Most frequent item
most_frequent <- item_freq_df[1, ]
most_frequent
# b. Largest transaction size
trans_sizes <- size(trans)
max_size <- max(trans_sizes)
max_size
# Transaction size distribution
hist(trans_sizes, breaks = 30, col = "steelblue",
main = "Distribution of Transaction Sizes",
xlab = "Number of Items", ylab = "Frequency")
abline(v = max_size, col = "red", lwd = 2, lty = 2)
png("transaction_sizes.png", width = 800, height = 500)
hist(trans_sizes, breaks = 30, col = "steelblue",
main = "Distribution of Transaction Sizes",
xlab = "Number of Items", ylab = "Frequency")
abline(v = max_size, col = "red", lwd = 2, lty = 2)
dev.off()
# Mine rules: support = 1%, confidence = 0%
rules_0conf <- apriori(trans, parameter = list(
support = 0.01,
confidence = 0,
minlen = 2
))
# c. Number of rules with 0% confidence
length(rules_0conf)
# d. Rules with 50% confidence
rules_50conf <- apriori(trans, parameter = list(
support = 0.01,
confidence = 0.5,
minlen = 2
))
length(rules_50conf)
# e. Impact of confidence on rules count
rules_stats <- data.frame(
Confidence = c(0, 0.1, 0.2, 0.3, 0.4, 0.5, 0.6, 0.7, 0.8),
Rules = sapply(c(0, 0.1, 0.2, 0.3, 0.4, 0.5, 0.6, 0.7, 0.8), function(conf) {
r <- apriori(trans, parameter = list(support = 0.01, confidence = conf, minlen = 2),
control = list(verbose = FALSE))
length(r)
})
)
rules_stats
# Scatter plot: Support vs Confidence, colored by Lift
plot(rules_0conf, measure = c("support", "confidence"), shading = "lift",
main = "Support vs Confidence (shaded by Lift)")
png("scatter_support_confidence_lift.png", width = 1000, height = 700)
plot(rules_0conf, measure = c("support", "confidence"), shading = "lift",
main = "Support vs Confidence (shaded by Lift)")
dev.off()
# g. Scatter plot: Support vs Lift
plot(rules_0conf, measure = c("support", "lift"), shading = "confidence",
main = "Support vs Lift (shaded by Confidence)")
png("scatter_support_lift.png", width = 1000, height = 700)
plot(rules_0conf, measure = c("support", "lift"), shading = "confidence",
main = "Support vs Lift (shaded by Confidence)")
dev.off()
# Filter rules with confidence > 0.8
high_conf_rules <- subset(rules_0conf, confidence > 0.8)
length(high_conf_rules)
# k. Sort by lift (highest first), then show 10 rules with LOWEST lift
rules_by_lift_desc <- sort(high_conf_rules, by = "lift", decreasing = TRUE)
rules_by_lift_asc <- sort(high_conf_rules, by = "lift", decreasing = FALSE)
# Top 10 highest lift (for observation)
inspect(head(rules_by_lift_desc, 10))
# 10 rules with LOWEST lift (question k asks for these)
inspect(head(rules_by_lift_asc, 10))
# Export high confidence rules to CSV
high_conf_df <- as(high_conf_rules, "data.frame")
high_conf_df <- high_conf_df[order(-high_conf_df$lift), ]
write.csv(high_conf_df, "high_confidence_rules.csv", row.names = FALSE)
# Create custom 2D color palette function
col_palette <- colorRampPalette(c("#313695", "#4575B4", "#74ADD1", "#ABD9E9",
"#E0F3F8", "#FFFFBF", "#FEE090", "#FDAE61",
"#F46D43", "#D73027", "#A50026"))
plot(high_conf_rules, method = "matrix",
measure = c("lift", "confidence"),
reorder = "none",
control = list(col = col_palette(100)))
png("matrix_confidence_lift.png", width = 1000, height = 800)
plot(high_conf_rules, method = "matrix",
measure = c("lift", "confidence"),
reorder = "none",
control = list(col = col_palette(100)))
dev.off()
# n. Extract 3 rules with highest lift from ALL rules (not just confidence > 0.8)
top3_lift_all <- head(sort(rules_0conf, by = "lift", decreasing = TRUE), 3)
inspect(top3_lift_all)
# Compare with top 3 from high confidence rules
top3_lift_highconf <- head(sort(high_conf_rules, by = "lift", decreasing = TRUE), 3)
inspect(top3_lift_highconf)
# o. Extract THREE rules with highest lift for graph visualization
top3_rules_graph <- head(sort(rules_0conf, by = "lift", decreasing = TRUE), 3)
inspect(top3_rules_graph)
# Graph-based visualization with items and rules as vertices
plot(top3_rules_graph, method = "graph", engine = "igraph")
png("graph_rules.png", width = 1000, height = 800)
plot(top3_rules_graph, method = "graph", engine = "igraph")
dev.off()
# Split transactions: first 8000 for training, last 2000 for testing
train_trans <- trans[1:8000]
test_trans <- trans[8001:10000]
# Mine rules on training set
rules_train <- apriori(train_trans, parameter = list(
support = 0.01,
confidence = 0.5,
minlen = 2
), control = list(verbose = FALSE))
# Mine rules on test set
rules_test <- apriori(test_trans, parameter = list(
support = 0.01,
confidence = 0.5,
minlen = 2
), control = list(verbose = FALSE))
# Compare results
comparison <- data.frame(
Dataset = c("Full (10000)", "Training (8000)", "Testing (2000)"),
Rules_Count = c(length(rules_50conf), length(rules_train), length(rules_test)),
Avg_Support = c(
mean(quality(rules_50conf)$support),
mean(quality(rules_train)$support),
mean(quality(rules_test)$support)
),
Avg_Confidence = c(
mean(quality(rules_50conf)$confidence),
mean(quality(rules_train)$confidence),
mean(quality(rules_test)$confidence)
),
Avg_Lift = c(
mean(quality(rules_50conf)$lift),
mean(quality(rules_train)$lift),
mean(quality(rules_test)$lift)
)
)
comparison
# Common rules analysis
train_rules_df <- as(rules_train, "data.frame")
test_rules_df <- as(rules_test, "data.frame")
# Find overlapping rules (q. Justify relationships are not artifacts)
common_rules <- intersect(train_rules_df$rules, test_rules_df$rules)
length(common_rules)
# Percentage overlap
overlap_pct <- length(common_rules) / length(rules_train) * 100
overlap_pct
# Show some common rules
common_idx <- which(train_rules_df$rules %in% common_rules)
head(train_rules_df[common_idx, ], 10)
# j. Rules appearing in at least 10% of transactions (support >= 0.1) - 3 rules
rules_10pct <- subset(rules_0conf, support >= 0.1)
inspect(rules_10pct)
# Interactive scatter plot to identify rules (for question j)
# Use plotly_arules for interactive exploration if available
plot(rules_0conf, method = "scatterplot", measure = c("support", "confidence"),
shading = "lift", main = "Interactive Scatter Plot")
png("scatter_interactive.png", width = 1000, height = 700)
plot(rules_0conf, method = "scatterplot", measure = c("support", "confidence"),
shading = "lift", main = "Scatter Plot for Rule Identification")
dev.off()
# l. Four interesting rules from matrix (highest lift with high confidence)
four_interesting <- head(sort(high_conf_rules, by = "lift", decreasing = TRUE), 4)
inspect(four_interesting)
# m. Rules with dark blue color (low lift, close to 1)
low_lift_rules <- subset(high_conf_rules, lift < 3)
inspect(head(sort(low_lift_rules, by = "lift"), 10))
# Save summary statistics
sink("analysis_results.txt")
cat("=== ASSOCIATION RULES ANALYSIS RESULTS ===\n\n")
cat("BASIC STATISTICS:\n")
cat("-----------------\n")
cat("Total transactions:", length(trans), "\n")
cat("Total items:", length(itemLabels(trans)), "\n")
cat("Average transaction size:", round(mean(trans_sizes), 2), "\n")
cat("Max transaction size (b):", max_size, "\n\n")
cat("a. MOST FREQUENT ITEM:\n")
cat("----------------------\n")
print(most_frequent)
cat("\n")
cat("TOP 10 FREQUENT ITEMS:\n")
cat("----------------------\n")
print(head(item_freq_df, 10))
cat("\n")
cat("c. RULES WITH 0% CONFIDENCE:\n")
cat("----------------------------\n")
cat("Number of rules:", length(rules_0conf), "\n\n")
cat("d. RULES WITH 50% CONFIDENCE:\n")
cat("-----------------------------\n")
cat("Number of rules:", length(rules_50conf), "\n\n")
cat("e. RULES COUNT BY CONFIDENCE:\n")
cat("-----------------------------\n")
print(rules_stats)
cat("\n")
cat("HIGH CONFIDENCE RULES (>0.8):\n")
cat("-----------------------------\n")
cat("Number of rules:", length(high_conf_rules), "\n\n")
cat("j. RULES WITH SUPPORT >= 10%:\n")
cat("-----------------------------\n")
print(as(rules_10pct, "data.frame"))
cat("\n")
cat("k. 10 RULES WITH LOWEST LIFT (from conf>0.8):\n")
cat("---------------------------------------------\n")
print(as(head(rules_by_lift_asc, 10), "data.frame"))
cat("\n")
cat("l. TOP 4 INTERESTING RULES (highest lift, conf>0.8):\n")
cat("----------------------------------------------------\n")
print(as(four_interesting, "data.frame"))
cat("\n")
cat("n. TOP 3 RULES BY LIFT (ALL RULES):\n")
cat("-----------------------------------\n")
print(as(top3_lift_all, "data.frame"))
cat("\n")
cat("TRAINING/TESTING COMPARISON (q, r):\n")
cat("-----------------------------------\n")
print(comparison)
cat("\n")
cat("Common rules between train and test:", length(common_rules), "\n")
cat("Percentage of train rules found in test:", round(overlap_pct, 1), "%\n")
sink()
# Final message
cat("\nAnalysis complete! Files saved:\n")
cat("- frequent_items_plot.png\n")
cat("- transaction_sizes.png\n")
cat("- scatter_support_confidence_lift.png\n")
cat("- scatter_support_lift.png\n")
cat("- scatter_interactive.png\n")
cat("- matrix_confidence_lift.png\n")
cat("- graph_rules.png\n")
cat("- high_confidence_rules.csv\n")
cat("- analysis_results.txt\n")
# Interactive scatter plot to identify rules (for question j)
# Use plotly_arules for interactive exploration if available
plot(rules_0conf, method = "scatterplot", measure = c("support", "confidence"),
shading = "lift", main = "Interactive Scatter Plot")
png("scatter_interactive.png", width = 1000, height = 700)
plot(rules_0conf, method = "scatterplot", measure = c("support", "confidence"),
shading = "lift", main = "Scatter Plot for Rule Identification")
dev.off()
# l. Four interesting rules from matrix (highest lift with high confidence)
four_interesting <- head(sort(high_conf_rules, by = "lift", decreasing = TRUE), 4)
inspect(four_interesting)
# m. Rules with dark blue color (low lift, close to 1)
low_lift_rules <- subset(high_conf_rules, lift < 3)
inspect(head(sort(low_lift_rules, by = "lift"), 10))
# Save summary statistics
sink("analysis_results.txt")
cat("=== ASSOCIATION RULES ANALYSIS RESULTS ===\n\n")
cat("BASIC STATISTICS:\n")
cat("-----------------\n")
cat("Total transactions:", length(trans), "\n")
cat("Total items:", length(itemLabels(trans)), "\n")
cat("Average transaction size:", round(mean(trans_sizes), 2), "\n")
source("~/studDir/DS_R/lab5/lab5_association_rules.R")
source("~/studDir/DS_R/lab5/lab5_association_rules.R")
source("~/studDir/DS_R/lab5/lab5_association_rules.R")
# Interactive scatter plot to identify rules (for question j)
# Use plotly_arules for interactive exploration if available
plot(rules_0conf, method = "scatterplot", measure = c("support", "confidence"),
shading = "lift", main = "Interactive Scatter Plot")
source("~/studDir/DS_R/lab5/lab5_association_rules.R", echo = TRUE)
source("~/studDir/DS_R/lab5/lab5_association_rules.R", echo = TRUE)
source("~/studDir/DS_R/lab5/lab5_association_rules.R", echo = TRUE)
source("~/studDir/DS_R/lab5/lab5_association_rules.R", echo = TRUE)
source("~/studDir/DS_R/lab5/lab5_association_rules.R", echo = TRUE)
source("~/studDir/DS_R/lab5/lab5_association_rules.R", echo = TRUE)
png("matrix_confidence.png", width = 1000, height = 800)
print(plot(high_conf_rules, method = "matrix",
measure = "confidence",
reorder = "none"))
# Matrix colored by LIFT
print(plot(high_conf_rules, method = "matrix",
measure = "lift",
reorder = "none"))
png("matrix_lift.png", width = 1000, height = 800)
print(plot(high_conf_rules, method = "matrix",
measure = "lift",
reorder = "none"))
dev.off()
# Matrix colored by CONFIDENCE
print(plot(high_conf_rules, method = "matrix",
measure = "confidence",
reorder = "none"))
png("matrix_confidence.png", width = 1000, height = 800)
print(plot(high_conf_rules, method = "matrix",
measure = "confidence",
reorder = "none"))
# Matrix colored by LIFT
print(plot(high_conf_rules, method = "matrix",
measure = "lift",
reorder = "none"))
png("matrix_lift.png", width = 1000, height = 800)
print(plot(high_conf_rules, method = "matrix",
measure = "lift",
reorder = "none"))
dev.off()
source("~/studDir/DS_R/lab5/lab5_association_rules.R", echo = TRUE)
source("~/studDir/DS_R/lab5/lab5_association_rules.R", echo = TRUE)
source("~/studDir/DS_R/lab5/lab5_association_rules.R", echo = TRUE)
source("~/studDir/DS_R/lab5/lab5_association_rules.R", echo = TRUE)
source("~/studDir/DS_R/lab5/lab5_association_rules.R", echo = TRUE)
source("~/studDir/DS_R/lab5/lab5_association_rules.R", echo = TRUE)
errorCondition()
warnings()
source("~/studDir/DS_R/lab5/lab5_association_rules.R", echo = TRUE)
source("~/studDir/DS_R/lab5/lab5_association_rules.R", echo = TRUE)
source("~/studDir/DS_R/lab5/lab5_association_rules.R", echo = TRUE)
source("~/studDir/DS_R/lab5/lab5_association_rules.R", echo = TRUE)
# Import transaction data
trans <- read.transactions("AssociationRules.csv", format = "basket", sep = " ")
# Basic info about transactions
summary(trans)
# Frequent item plot
itemFrequencyPlot(trans, topN = 20, type = "absolute",
main = "Top 20 Most Frequent Items",
col = "steelblue", horiz = TRUE)
png("frequent_items_plot.png", width = 1200, height = 600)
itemFrequencyPlot(trans, topN = 20, type = "absolute",
main = "Top 20 Most Frequent Items",
col = "steelblue", horiz = TRUE)
dev.off()
# Frequent item table
item_freq <- itemFrequency(trans, type = "absolute")
item_freq_df <- data.frame(
Item = names(item_freq),
Frequency = as.numeric(item_freq),
Support = as.numeric(itemFrequency(trans, type = "relative"))
)
item_freq_df <- item_freq_df[order(-item_freq_df$Frequency), ]
head(item_freq_df, 20)
# a. Most frequent item
most_frequent <- item_freq_df[1, ]
most_frequent
