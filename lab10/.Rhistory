source("~/studDir/DS_R/lab10/lab10.R", echo = TRUE)
source("~/studDir/DS_R/lab10/lab10.R", echo = TRUE)
warnings()
source("~/studDir/DS_R/lab10/lab10.R", echo = TRUE)
warnings()
source("~/studDir/DS_R/lab10/lab10.R", echo = TRUE)
pdf("plots.pdf", width = 10, height = 8)
jj <- scan("jj.dat")
jj_ts <- ts(jj, start = c(1960, 1), frequency = 4)
par(mfrow = c(1, 1))
plot(jj_ts, main = "Johnson & Johnson EPS", xlab = "Year", ylab = "EPS", col = "blue", lwd = 2)
plot(jj_ts, main = "Johnson & Johnson EPS", xlab = "Year", ylab = "EPS", col = "blue", lwd = 2)
diff_jj <- diff(jj_ts)
par(mfrow = c(2, 1))
plot(jj_ts, main = "Original EPS Series", xlab = "Year", ylab = "EPS", col = "blue")
plot(diff_jj, main = "Difference (xt - xt-1)", xlab = "Year", ylab = "Diff EPS", col = "red")
log_jj <- log10(jj_ts)
diff_log_jj <- diff(log_jj)
par(mfrow = c(2, 1))
plot(log_jj, main = "log10(EPS)", xlab = "Year", ylab = "log10(EPS)", col = "blue")
plot(diff_log_jj, main = "Difference log10(xt) - log10(xt-1)", xlab = "Year", ylab = "Diff log10(EPS)", col = "red")
par(mfrow = c(2, 1))
acf(diff_log_jj, main = "ACF of Differenced log10(EPS)", lag.max = 20)
pacf(diff_log_jj, main = "PACF of Differenced log10(EPS)", lag.max = 20)
model1 <- arima(log_jj, order = c(0, 1, 1), seasonal = list(order = c(0, 1, 1), period = 4))
model2 <- arima(log_jj, order = c(1, 1, 0), seasonal = list(order = c(0, 1, 1), period = 4))
model3 <- arima(log_jj, order = c(1, 1, 1), seasonal = list(order = c(0, 1, 1), period = 4))
model4 <- arima(log_jj, order = c(0, 1, 1), seasonal = list(order = c(1, 1, 1), period = 4))
cat("AIC моделей:\n")
cat("ARIMA(0,1,1)x(0,1,1)[4]:", AIC(model1), "\n")
cat("ARIMA(1,1,0)x(0,1,1)[4]:", AIC(model2), "\n")
cat("ARIMA(1,1,1)x(0,1,1)[4]:", AIC(model3), "\n")
cat("ARIMA(0,1,1)x(1,1,1)[4]:", AIC(model4), "\n")
best_model <- model1
cat("\nЛучшая модель (минимальный AIC):\n")
print(best_model)
par(mfrow = c(2, 2))
tsdiag(best_model)
set.seed(123)
par(mfrow = c(4, 3))
ar1 <- arima.sim(n = 10000, list(ar = c(0.9)))
plot(ar1[1:200], type = "l", main = "AR(1)", ylab = "")
acf(ar1, main = "ACF AR(1)")
pacf(ar1, main = "PACF AR(1)")
ar2 <- arima.sim(n = 10000, list(ar = c(0.9, -0.5)))
plot(ar2[1:200], type = "l", main = "AR(2)", ylab = "")
acf(ar2, main = "ACF AR(2)")
pacf(ar2, main = "PACF AR(2)")
ar3 <- arima.sim(n = 10000, list(ar = c(0.9, -0.5, 0.2)))
plot(ar3[1:200], type = "l", main = "AR(3)", ylab = "")
acf(ar3, main = "ACF AR(3)")
pacf(ar3, main = "PACF AR(3)")
ar4 <- arima.sim(n = 10000, list(ar = c(0.9, -0.5, 0.2, -0.3)))
plot(ar4[1:200], type = "l", main = "AR(4)", ylab = "")
acf(ar4, main = "ACF AR(4)")
pacf(ar4, main = "PACF AR(4)")
set.seed(123)
par(mfrow = c(4, 3))
ma1 <- arima.sim(n = 10000, list(ma = c(-1.9)))
plot(ma1[1:200], type = "l", main = "MA(1)", ylab = "")
acf(ma1, main = "ACF MA(1)")
pacf(ma1, main = "PACF MA(1)")
ma2 <- arima.sim(n = 10000, list(ma = c(-1.9, 1.7)))
plot(ma2[1:200], type = "l", main = "MA(2)", ylab = "")
acf(ma2, main = "ACF MA(2)")
pacf(ma2, main = "PACF MA(2)")
ma3 <- arima.sim(n = 10000, list(ma = c(-1.9, 1.7, -1.5)))
plot(ma3[1:200], type = "l", main = "MA(3)", ylab = "")
acf(ma3, main = "ACF MA(3)")
pacf(ma3, main = "PACF MA(3)")
ma4 <- arima.sim(n = 10000, list(ma = c(-1.9, 1.7, -1.5, 1.5)))
plot(ma4[1:200], type = "l", main = "MA(4)", ylab = "")
acf(ma4, main = "ACF MA(4)")
pacf(ma4, main = "PACF MA(4)")
dev.off()
source("~/studDir/DS_R/lab10/lab10.R", echo = TRUE)
source("~/studDir/DS_R/lab10/lab10.R", echo = TRUE)
source("~/studDir/DS_R/lab10/lab10.R", echo = TRUE)
source("~/studDir/DS_R/lab10/lab10.R", echo = TRUE)
source("~/studDir/DS_R/lab10/lab10.R", echo = TRUE)
source("~/studDir/DS_R/lab10/lab10.R", echo = TRUE)
source("~/studDir/DS_R/lab10/lab10.R", echo = TRUE)
source("~/studDir/DS_R/lab10/lab10.R", echo = TRUE)
source("~/studDir/DS_R/lab10/lab10.R", echo = TRUE)
source("~/studDir/DS_R/lab10/lab10.R", echo = TRUE)
for(p in 0:3) {
tryCatch({
models_p[[p+1]] <- arima(log_jj, order = c(p, 1, 1), seasonal = list(order = c(0, 1, 1), period = 4))
}, error = function(e) {})
}
models_q <- list()
for(q in 0:3) {
tryCatch({
models_q[[q+1]] <- arima(log_jj, order = c(0, 1, q), seasonal = list(order = c(0, 1, 1), period = 4))
}, error = function(e) {})
}
results <- list()
for(p in 0:2) {
for(q in 0:2) {
tryCatch({
mod <- arima(log_jj, order = c(p, 1, q), seasonal = list(order = c(0, 1, 1), period = 4))
results[[paste0(p, "-", q)]] <- mod
}, error = function(e) {})
}
}
model_s1 <- arima(log_jj, order = c(0, 1, 1), seasonal = list(order = c(0, 1, 1), period = 4))
model_s2 <- arima(log_jj, order = c(0, 1, 1), seasonal = list(order = c(1, 1, 0), period = 4))
model_s3 <- arima(log_jj, order = c(0, 1, 1), seasonal = list(order = c(1, 1, 1), period = 4))
model_s4 <- arima(log_jj, order = c(0, 1, 1), seasonal = list(order = c(0, 1, 0), period = 4))
model_season0 <- arima(log_jj, order = c(0, 1, 1), seasonal = list(order = c(0, 0, 1), period = 4))
model_season1 <- arima(log_jj, order = c(0, 1, 1), seasonal = list(order = c(0, 1, 1), period = 4))
all_models <- list(
"ARIMA(0,1,1)x(0,1,1)" = arima(log_jj, order = c(0, 1, 1), seasonal = list(order = c(0, 1, 1), period = 4)),
"ARIMA(1,1,0)x(0,1,1)" = arima(log_jj, order = c(1, 1, 0), seasonal = list(order = c(0, 1, 1), period = 4)),
"ARIMA(1,1,1)x(0,1,1)" = arima(log_jj, order = c(1, 1, 1), seasonal = list(order = c(0, 1, 1), period = 4)),
"ARIMA(0,1,1)x(1,1,1)" = arima(log_jj, order = c(0, 1, 1), seasonal = list(order = c(1, 1, 1), period = 4))
)
best_aic <- Inf
best_model <- NULL
best_name <- ""
aic_values <- sapply(all_models, AIC)
for(i in seq_along(all_models)) {
if(aic_values[i] < best_aic) {
best_aic <- aic_values[i]
best_model <- all_models[[i]]
best_name <- names(all_models)[i]
}
}
mod_d0 <- suppressWarnings(arima(log_jj, order = c(2, 0, 2)))
mod_d1 <- arima(log_jj, order = c(2, 1, 2))
mod_d2 <- suppressWarnings(arima(log_jj, order = c(2, 2, 2)))
par(mfrow = c(2, 2))
tsdiag(best_model, gof.lag = 20)
set.seed(123)
par(mfrow = c(4, 3))
ar1 <- arima.sim(n = 10000, list(ar = c(0.9)))
plot(ar1[1:200], type = "l", main = "AR(1), phi=0.9", ylab = "")
acf(ar1, main = "ACF AR(1)")
pacf(ar1, main = "PACF AR(1)")
source("~/studDir/DS_R/lab10/lab10.R", echo = TRUE)
View(mod)
print(mod)
print(results)
model_s1 <- arima(log_jj, order = c(0, 1, 1), seasonal = list(order = c(0, 1, 1), period = 4))
results <- list()
for(p in 0:2) {
for(q in 0:2) {
tryCatch({
mod <- arima(log_jj, order = c(p, 1, q), seasonal = list(order = c(0, 1, 1), period = 4))
results[[paste0(p, "-", q)]] <- mod
}, error = function(e) {})
}
}
print(results)
source("~/studDir/DS_R/lab10/lab10.R", echo = TRUE)
for(p in 0:3) {
cat("Fitting ARIMA(", p, ",1,1)×(0,1,1)[4]...\n", sep="")
tryCatch({
models_p[[p+1]] <- arima(log_jj, order = c(p, 1, 1), seasonal = list(order = c(0, 1, 1), period = 4))
cat("  AIC =", AIC(models_p[[p+1]]), "\n")
}, error = function(e) {
cat("  ERROR:", conditionMessage(e), "\n")
})
}
for(p in 0:10) {
cat("Fitting ARIMA(", p, ",1,1)×(0,1,1)[4]...\n", sep="")
tryCatch({
models_p[[p+1]] <- arima(log_jj, order = c(p, 1, 1), seasonal = list(order = c(0, 1, 1), period = 4))
cat("  AIC =", AIC(models_p[[p+1]]), "\n")
}, error = function(e) {
cat("  ERROR:", conditionMessage(e), "\n")
})
}
for(q in 0:3) {
cat("Fitting ARIMA(0,1,", q, ")×(0,1,1)[4]...\n", sep="")
tryCatch({
models_q[[q+1]] <- arima(log_jj, order = c(0, 1, q), seasonal = list(order = c(0, 1, 1), period = 4))
cat("  AIC =", AIC(models_q[[q+1]]), "\n")
}, error = function(e) {
cat("  ERROR:", conditionMessage(e), "\n")
})
}
for(q in 0:3) {
cat("Fitting ARIMA(0,1,", q, ")×(0,1,1)[4]...\n", sep="")
tryCatch({
models_q[[q+1]] <- arima(log_jj, order = c(0, 1, q)))
for(q in 0:3) {
cat("Fitting ARIMA(0,1,", q, ")×(0,1,1)[4]...\n", sep="")
tryCatch({
models_q[[q+1]] <- arima(log_jj, order = c(0, 1, q))
cat("  AIC =", AIC(models_q[[q+1]]), "\n")
}, error = function(e) {
cat("  ERROR:", conditionMessage(e), "\n")
})
}
for(q in 0:10) {
cat("Fitting ARIMA(0,1,", q, ")×(0,1,1)[4]...\n", sep="")
tryCatch({
models_q[[q+1]] <- arima(log_jj, order = c(0, 1, q))
cat("  AIC =", AIC(models_q[[q+1]]), "\n")
}, error = function(e) {
cat("  ERROR:", conditionMessage(e), "\n")
})
}
for(p in 0:6) {
for(q in 0:6) {
cat("Fitting ARIMA(", p, ",1,", q, ")...\n", sep="")
tryCatch({
mod <- arima(log_jj, order = c(p, 1, q))
results[[paste0(p, "-", q)]] <- mod
cat("  AIC =", AIC(mod), "\n")
}, error = function(e) {
cat("  ERROR:", conditionMessage(e), "\n")
})
}
}
for(p in 0:6) {
for(q in 0:6) {
cat("Fitting ARIMA(", p, ",1,", q, ")...\n", sep="")
tryCatch({
mod <- arima(log_jj, order = c(p, 1, q))
results[[paste0(p, "-", q)]] <- mod
cat("  AIC =", AIC(mod), "\n")
}, error = function(e) {
cat("  ERROR:", conditionMessage(e), "\n")
})
}
}
