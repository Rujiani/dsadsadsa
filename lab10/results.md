# РЕЗУЛЬТАТЫ ЭКСПЕРИМЕНТОВ С ARIMA МОДЕЛЯМИ

## КАК ЧИТАТЬ ACF/PACF И ВЫБИРАТЬ ПАРАМЕТРЫ AR И MA

### Что такое ACF и PACF?

**ACF (Автокорреляционная функция)** — показывает корреляцию между значением ряда в момент t и значением в момент t-k (где k — лаг). 
- Если ACF на лаге k значима, значит значения ряда коррелируют с значениями k шагов назад
- Для MA(q) процессов: ACF обрывается (cutoff) после лага q

**PACF (Частная автокорреляционная функция)** — показывает корреляцию между значениями в моменты t и t-k, исключая влияние промежуточных значений (t-1, t-2, ..., t-k+1).
- Для AR(p) процессов: PACF обрывается (cutoff) после лага p

### Как по графикам AR/MA симуляций определить параметры?

**Методология выбора параметров:**

1. **Смотрим на ACF реальных данных (diff(log_jj)):**
   - Если ACF обрывается резко после лага q → нужна MA(q)
   - Если ACF затухает постепенно → возможна AR компонента

2. **Смотрим на PACF реальных данных:**
   - Если PACF обрывается резко после лага p → нужна AR(p)
   - Если PACF затухает постепенно → возможна MA компонента

3. **Сравниваем с симуляциями:**
   - Графики AR показывают: для AR(4) PACF имеет 4 значимых пика (лаги 1,2,3,4)
   - Графики MA показывают: для MA(1) ACF имеет 1 значимый пик (лаг 1)

### Визуальный гайд по чтению графиков симуляций

**Графики AR процессов (верхние 4 ряда):**

Смотрим на **правый столбец (PACF)**:
- **AR(1)**: 1 значимый пик (лаг 1), затем обрыв
- **AR(2)**: 2 значимых пика (лаги 1, 2), затем обрыв
- **AR(3)**: 3 значимых пика (лаги 1, 2, 3), затем обрыв
- **AR(4)**: 4 значимых пика (лаги 1, 2, 3, 4), затем обрыв ← **НАШ СЛУЧАЙ**

**Правило:** Количество значимых пиков в PACF = порядок AR

**Графики MA процессов (нижние 4 ряда):**

Смотрим на **средний столбец (ACF)** — это самое важное для MA!

**Как считать значимые пики:**
- Значимый пик = столбик, который ВЫХОДИТ за синие пунктирные линии (доверительные интервалы)
- Если столбик внутри синих линий = незначим

**MA(1)** (первый ряд):
- 1 значимый пик на лаге 1 (выходит за синие линии) ← **НАШ СЛУЧАЙ**
- Все остальные лаги (2, 3, 4...) внутри синих линий = незначимы
- **Обрыв после лага 1**

**MA(2)** (второй ряд):
- 2 значимых пика на лагах 1 и 2
- Обрыв после лага 2

**MA(3)** (третий ряд):
- 3 значимых пика на лагах 1, 2, 3
- Обрыв после лага 3

**MA(4)** (четвёртый ряд):
- 4 значимых пика на лагах 1, 2, 3, 4
- Обрыв после лага 4

**Правило:** 
- Количество значимых пиков в ACF (до первого обрыва) = порядок MA
- Для MA(1): один пик на лаге 1, затем всё внутри синих линий

**Важно:** Значимыми считаются пики, которые выходят за синие пунктирные линии (доверительные интервалы).

### Анализ графиков для определения AR=4, MA=1

**Реальные данные для diff(log_jj):**

**ACF (Автокорреляционная функция):**
- Lag 1: -0.5068 (значимо) ← **ЭТО КЛЮЧЕВОЙ ПРИЗНАК MA(1)**
- Lag 3: -0.4028 (значимо)
- Lag 4: 0.7314 (значимо) ← сезонность
- Lag 5: -0.3666 (значимо)
- Lag 7-12: постепенное затухание с сезонными пиками
- Затухание происходит постепенно (не резко)

**PACF (Частная автокорреляционная функция):**
- Lag 1: -0.5068 (значимо)
- Lag 2: -0.2554 (значимо)
- Lag 3: -0.7047 (значимо)
- Lag 4: 0.2651 (значимо) ← **ОБРЫВ ПОСЛЕ ЛАГА 4**
- Lag 5+: все незначимы (в пределах доверительных интервалов)

### Как определить AR=4 по графикам?

**Сравнение с симуляциями AR(4):**
1. Смотрим на график PACF для AR(4) в симуляциях:
   - Видим 4 значимых пика на лагах 1, 2, 3, 4
   - После лага 4 PACF резко обрывается (все значения незначимы)

2. Смотрим на PACF реальных данных:
   - **ТОЧНО ТАК ЖЕ**: 4 значимых пика на лагах 1, 2, 3, 4
   - После лага 4 резкий обрыв → это классический признак AR(4)!

**Правило:** Если PACF обрывается после лага p, значит нужна AR(p) компонента.

### Как определить MA=1 по графикам? (ПОДРОБНОЕ ОБЪЯСНЕНИЕ)

**ПРОСТЫМИ СЛОВАМИ:**
- MA — Moving Average (скользящее среднее)
- MA(q) означает: текущее значение зависит от последних q ошибок модели
- Чтобы найти q, смотрим на график ACF (средний столбец в симуляциях)

**ШАГ 1: Что такое MA процесс?**

MA (Moving Average) — текущее значение зависит от ПРОШЛЫХ ОШИБОК модели, а не от прошлых значений ряда.

**ШАГ 2: Смотрим на графики MA симуляций (нижние 4 ряда)**

**Ключевое правило для MA:** Смотрим на СРЕДНИЙ столбец (ACF)!

**MA(1) (первый ряд, средний график):**
- ✅ ОДИН значимый пик на лаге 1 (выходит за синие линии)
- ✅ После лага 1 — ВСЁ внутри синих линий (незначимо)
- ✅ Это "резкий обрыв" (cutoff) после лага 1
- **Вывод:** ACF обрывается после лага 1 → MA(1)

**MA(2) (второй ряд, средний график):**
- ✅ ДВА значимых пика на лагах 1 и 2
- ✅ После лага 2 — всё внутри синих линий
- ✅ Резкий обрыв после лага 2
- **Вывод:** ACF обрывается после лага 2 → MA(2)

**MA(3) (третий ряд, средний график):**
- ✅ ТРИ значимых пика на лагах 1, 2, 3
- ✅ После лага 3 — всё внутри синих линий
- **Вывод:** ACF обрывается после лага 3 → MA(3)

**MA(4) (четвёртый ряд, средний график):**
- ✅ ЧЕТЫРЕ значимых пика на лагах 1, 2, 3, 4
- ✅ После лага 4 — всё внутри синих линий
- **Вывод:** ACF обрывается после лага 4 → MA(4)

**ШАГ 3: Сравниваем с реальными данными**

**ACF для diff(log_jj):**
- Lag 1: -0.5068 ← **ЭТО ЗНАЧИМЫЙ ПИК!** (выходит за доверительные границы)
- Lag 2: меньше, но может быть значим
- Lag 3, 4, 5... — есть пики, но они связаны с сезонностью

**Важный момент:**
- На лаге 1 есть СИЛЬНЫЙ значимый пик (-0.5068)
- Это похоже на MA(1) — один основной пик на первом лаге
- Хотя дальше есть другие пики, они могут быть из-за сезонности или AR компоненты

**ШАГ 4: Почему именно MA(1)? ВОПРОС: А почему не больше пиков?**

**ХОРОШИЙ ВОПРОС!** В реальных данных ACF имеет НЕ ТОЛЬКО пик на лаге 1:

**Все значимые пики в ACF наших данных:**
- Lag 1: -0.5068 ← **САМЫЙ СИЛЬНЫЙ**
- Lag 3: -0.4028
- Lag 4: 0.7314 ← **СЕЗОННОСТЬ** (кратный 4)
- Lag 5: -0.3666
- Lag 7: -0.2514
- Lag 8: 0.5575 ← **СЕЗОННОСТЬ** (кратный 4)
- Lag 9: -0.2794
- Lag 11: -0.2178
- Lag 12: 0.4505 ← **СЕЗОННОСТЬ** (кратный 4)

**Почему мы выбираем MA(1), а не MA(4) или больше?**

### Правило интерпретации ACF в смешанных процессах:

**1. Первый лаг — это ключевой показатель MA компоненты:**
- Если на лаге 1 есть сильный значимый пик → это признак MA(1)
- Это "чистый" эффект от прошлых ошибок модели
- Не загрязнён сезонностью или AR эффектами

**2. Остальные пики могут быть из-за:**
- **Сезонности**: пики на лагах 4, 8, 12 (кратные 4) — это НЕ MA эффект!
- **AR компоненты**: постепенное затухание после лага 1 — это AR эффект
- **Комбинации**: когда есть и AR, и MA, пики могут быть смешаны

**3. Как правильно определить MA в смешанном процессе:**

**Смотрим на ПЕРВЫЙ лаг:**
- Lag 1: -0.5068 — очень сильный пик ← это MA(1)
- Если бы это был чистый MA(4), пики были бы на лагах 1,2,3,4 примерно одинаковой силы
- Но у нас: пик на лаге 1 сильный, на лагах 2,3 слабые → это MA(1)

**4. Сезонные пики — это отдельная история:**
- Пики на лагах 4, 8, 12 — это сезонность (период 4)
- Они обрабатываются сезонной частью модели: (P, D, Q)[4]
- Это НЕ часть несезонной MA компоненты

**5. Почему не MA(4)?**

Если бы это был чистый MA(4):
- Пики на лагах 1, 2, 3, 4 были бы примерно одинаковой силы
- После лага 4 был бы РЕЗКИЙ обрыв

У нас же:
- Lag 1: очень сильный (-0.51)
- Lag 2: слабый
- Lag 3: средний (-0.40), но это может быть AR эффект
- Lag 4: сильный (0.73), но это СЕЗОННОСТЬ, не MA!

**Вывод:**
- ✅ Lag 1 указывает на MA(1)
- ✅ Лаги 4, 8, 12 — сезонность (обрабатывается отдельно)
- ✅ Остальные лаги — AR эффекты или смешанные эффекты

**Поэтому модель ARIMA(4,1,1) имеет смысл:**
- AR(4) — ловит зависимости на лагах 1-4 (видно в PACF)
- MA(1) — ловит эффект на лаге 1 (видно в ACF)
- Сезонность — обрабатывается отдельной сезонной частью или уже учтена в AR(4)

**ШАГ 5: Как это работает на практике**

**Если бы ACF выглядела так:**
- Лаги 1, 2 значимы, остальные нет → MA(2)
- Лаги 1, 2, 3 значимы, остальные нет → MA(3)
- Лаги 1, 2, 3, 4 значимы, остальные нет → MA(4)

**В нашем случае:**
- Лаг 1 очень значим, затем затухание → MA(1)

**Правило:** Количество значимых пиков в начале ACF (до первого обрыва) = порядок MA

### Почему ARIMA(4,1,1) оптимальна?

**Комбинация признаков:**
- ✅ PACF обрывается после лага 4 → нужна AR(4)
- ✅ ACF имеет сильный пик на лаге 1 → нужна MA(1)
- ✅ Обе зависимости присутствуют в данных

**Важно:** 
- AR и MA компоненты не взаимоисключающие - они могут работать вместе
- AR(4) улавливает долгосрочные зависимости (4 квартала)
- MA(1) улавливает краткосрочную корреляцию с прошлыми ошибками
- Вместе они лучше описывают структуру данных

**Сравнение с сезонной моделью:**
- ARIMA(0,1,1)×(0,1,1)[4] — фокус на сезонности
- ARIMA(4,1,1) — фокус на авторегрессионной структуре без явной сезонности
- Обе модели валидны, но описывают разные аспекты данных

---

# РЕЗУЛЬТАТЫ ЭКСПЕРИМЕНТОВ С ARIMA МОДЕЛЯМИ

## ЭКСПЕРИМЕНТ 1: Влияние параметра d (дифференцирование)

Проверяем модели БЕЗ дифференцирования (d=0) и С дифференцированием (d=1)

| Модель | d | AIC | Вывод |
|--------|---|-----|-------|
| ARIMA(1,0,1)×(0,1,1)[4] | 0 | -283.9739 | Без дифференцирования |
| ARIMA(1,1,1)×(0,1,1)[4] | 1 | -280.5477 | С дифференцированием |

**Анализ:** Хотя модель с d=0 показывает немного лучший AIC (-283.97 vs -280.55), это не означает, что она лучше. Предупреждение о сходимости при d=0 указывает на проблему: ряд нестационарный без дифференцирования. Модель с d=1 более надёжна и правильно убирает тренд, что критично для последующего анализа.

**Вывод:** d=1 необходим для стационаризации ряда и убирания тренда.

## ЭКСПЕРИМЕНТ 2: Влияние параметра p (AR компонента)

Проверяем разные значения p при фиксированных d=1, q=1

| p | Модель | AIC |
|---|--------|-----|
| 0 | ARIMA(0,1,1)×(0,1,1)[4] | -282.5299 |
| 1 | ARIMA(1,1,1)×(0,1,1)[4] | -280.5477 |
| 2 | ARIMA(2,1,1)×(0,1,1)[4] | -280.3392 |
| 3 | ARIMA(3,1,1)×(0,1,1)[4] | -279.7717 |

**Анализ:** Чем больше p, тем хуже модель (выше AIC). p=0 даёт наилучший результат. Это означает, что авторегрессионная компонента не улучшает модель - зависимости между прошлыми значениями уже учтены через дифференцирование и MA компоненту.

**Вывод:** p = 0 оптимально, AR компонента не нужна.

## ЭКСПЕРИМЕНТ 3: Влияние параметра q (MA компонента)

Проверяем разные значения q при фиксированных d=1, p=0

| q | Модель | AIC |
|---|--------|-----|
| 0 | ARIMA(0,1,0)×(0,1,1)[4] | -258.1264 |
| 1 | ARIMA(0,1,1)×(0,1,1)[4] | -282.5299 |
| 2 | ARIMA(0,1,2)×(0,1,1)[4] | -280.5403 |
| 3 | ARIMA(0,1,3)×(0,1,1)[4] | -281.2021 |

**Анализ:** Резкий скачок качества при переходе от q=0 к q=1 (AIC улучшается с -258.13 до -282.53). q=1 даёт лучший результат. Увеличение q до 2-3 ухудшает модель - избыточная сложность не оправдана.

**Вывод:** q = 1 критически важен и оптимален.

## ЭКСПЕРИМЕНТ 4: Комбинации p и q

Систематическая проверка разных комбинаций

| p | q | Модель | AIC |
|---|---|--------|-----|
| 0 | 0 | ARIMA(0,1,0)×(0,1,1)[4] | -258.1264 |
| 0 | 1 | ARIMA(0,1,1)×(0,1,1)[4] | -282.5299 |
| 0 | 2 | ARIMA(0,1,2)×(0,1,1)[4] | -280.5403 |
| 1 | 0 | ARIMA(1,1,0)×(0,1,1)[4] | -277.7962 |
| 1 | 1 | ARIMA(1,1,1)×(0,1,1)[4] | -280.5477 |
| 1 | 2 | ARIMA(1,1,2)×(0,1,1)[4] | -279.4783 |
| 2 | 0 | ARIMA(2,1,0)×(0,1,1)[4] | -276.5286 |
| 2 | 1 | ARIMA(2,1,1)×(0,1,1)[4] | -280.3392 |
| 2 | 2 | ARIMA(2,1,2)×(0,1,1)[4] | -279.1643 |

**Лучшие модели (топ 5 по AIC):**

| Ранг | p | q | AIC |
|------|---|---|-----|
| 1 | 0 | 1 | -282.5299 |
| 2 | 1 | 1 | -280.5477 |
| 3 | 0 | 2 | -280.5403 |
| 4 | 2 | 1 | -280.3392 |
| 5 | 1 | 2 | -279.4783 |

**Анализ:** Чётко видно, что комбинация (p=0, q=1) значительно превосходит все остальные. Это подтверждает выводы из предыдущих экспериментов: AR компонента не нужна, а MA(1) критически важна.

## ЭКСПЕРИМЕНТ 5: Влияние сезонных параметров

Проверяем разные сезонные компоненты

| Сезонная часть | Модель | AIC |
|----------------|--------|-----|
| (0,1,1) | ARIMA(0,1,1)×(0,1,1)[4] | -282.5299 |
| (1,1,0) | ARIMA(0,1,1)×(1,1,0)[4] | -282.6906 |
| (1,1,1) | ARIMA(0,1,1)×(1,1,1)[4] | -280.9088 |
| (0,1,0) | ARIMA(0,1,1)×(0,1,0)[4] | -277.2910 |

**Анализ:** Интересно, что модель (1,1,0) показывает чуть лучший AIC (-282.69 vs -282.53), но разница минимальна (< 0.2). Обе модели практически эквивалентны. Модель (0,1,1) более простая и классическая ("airline model"), что предпочтительнее по принципу Occam's razor.

**Вывод:** (0,1,1) оптимально - простая и эффективная модель.

## ЭКСПЕРИМЕНТ 6: Влияние сезонного дифференцирования D

Проверяем сезонное дифференцирование D

| D | Модель | AIC |
|---|--------|-----|
| 0 | ARIMA(0,1,1)×(0,0,1)[4] (без сезонного diff) | -228.8048 |
| 1 | ARIMA(0,1,1)×(0,1,1)[4] (с сезонным diff) | -282.5299 |

**Анализ:** Огромная разница в AIC (более 50 пунктов)! Сезонное дифференцирование критически важно. Без него (D=0) модель практически бесполезна (AIC = -228.8). С D=1 модель отлично работает.

**Вывод:** D = 1 абсолютно необходим для убирания сезонности.

## ИТОГОВОЕ СРАВНЕНИЕ ВСЕХ МОДЕЛЕЙ

| Модель | AIC |
|--------|-----|
| ARIMA(0,1,1)x(0,1,1) | -282.5299 |
| ARIMA(1,1,0)x(0,1,1) | -277.7962 |
| ARIMA(1,1,1)x(0,1,1) | -280.5477 |
| ARIMA(0,1,1)x(1,1,1) | -280.9088 |

**Лучшая модель:** ARIMA(0,1,1)x(0,1,1) с AIC = -282.5299

### Детальная информация о лучшей модели

**Call:**
```
arima(x = log_jj, order = c(0, 1, 1), seasonal = list(order = c(0, 1, 1), period = 4))
```

**Coefficients:**
- ma1 = -0.6809 (s.e. = 0.0982)
- sma1 = -0.3146 (s.e. = 0.1070)

**sigma^2:** 0.001496
**log likelihood:** 144.26
**AIC:** -282.53

### Анализ коэффициентов лучшей модели

| Коэффициент | Estimate | Std.Error | t_value | Significant |
|-------------|----------|-----------|---------|-------------|
| ma1 | -0.6809 | 0.0982 | -6.9319 | ДА |
| sma1 | -0.3146 | 0.1070 | -2.9402 | ДА |

**Интерпретация:**
- Если |t_value| > 2, то коэффициент значим (p < 0.05)
- Знак Estimate показывает направление влияния
- Std.Error - стандартная ошибка (чем меньше, тем точнее оценка)

**Детальный анализ:**
- **ma1 = -0.6809**: Очень значимый (t = -6.93 >> 2). Отрицательное значение означает, что текущее значение ряда коррелирует с прошлыми ошибками отрицательно. Это типично для финансовых данных.
- **sma1 = -0.3146**: Значимый (t = -2.94 > 2). Сезонная MA компонента также отрицательна и значима, что указывает на сезонную структуру в ошибках модели.

## ЭКСПЕРИМЕНТ 8: Сравнение разных значений d

| d | Модель | AIC | Статус |
|---|--------|-----|--------|
| 0 | ARIMA(2,0,2) | -177.8859 | Предупреждение о сходимости |
| 1 | ARIMA(2,1,2) | -190.6590 | Нет |
| 2 | ARIMA(2,2,2) | -181.6142 | Возможно предупреждение |

**Анализ:** d=1 даёт лучший результат (-190.66). d=0 хуже и выдаёт предупреждение (ряд нестационарный). d=2 хуже d=1 - возможно передифференцирование.

**Вывод:** d=1 обычно достаточно, d=2 может передифференцировать ряд. Предупреждение о сходимости при d=0 - это нормально (ряд нестационарный).

## АНАЛИЗ ГРАФИКОВ И ВИЗУАЛИЗАЦИЯ

### 1. Исходный ряд EPS

**Наблюдения:**
- Чёткий растущий ТРЕНД: EPS увеличился с 0.44 до 16.20 за 21 год (рост в 36 раз!)
- Постоянный экспоненциальный рост - значения растут всё быстрее
- СЕЗОННОСТЬ: повторяющийся паттерн каждый год (четверть года) - видно 4 "зубца" на год
- Увеличение АМПЛИТУДЫ колебаний со временем (гетероскедастичность) - в начале колебания небольшие, к концу становятся огромными

**Вывод:** Ряд НЕСТАЦИОНАРНЫЙ (есть тренд, меняется дисперсия). Требуется преобразование.

### 2. Простое дифференцирование (diff)

**Наблюдения:**
- Тренд частично убран - ряд теперь колеблется около нуля
- НО дисперсия всё ещё нестабильна - видно, что колебания непостоянны
- В начале колебания меньше (около -0.5 до 0.5), в конце больше (от -3 до 3)
- Это классический признак гетероскедастичности

**Вывод:** Простое дифференцирование НЕ достаточно для стационарности. Нужна стабилизация дисперсии.

### 3. Логарифмирование + дифференцирование

**log10(EPS):**
- Тренд стал более линейным - экспоненциальный рост превратился в линейный
- Сезонность сохранилась - всё ещё видны повторяющиеся паттерны
- Масштаб значений стал более управляемым (от примерно -0.35 до 1.2)

**diff(log10(EPS)):**
- Тренд УБРАН - ряд теперь колеблется вокруг нуля без систематического смещения
- Дисперсия стала СТАБИЛЬНОЙ - колебания примерно одинаковы по всей длине ряда
- Амплитуда примерно одинакова на всём протяжении (от -0.15 до 0.15)
- Ряд выглядит стационарным! - нет тренда, постоянная дисперсия

**Вывод:** Комбинация log + diff эффективно стационаризует ряд. Это оптимальное преобразование для данного типа данных.

### 4. ACF и PACF разности логарифмов

**ACF (Автокорреляционная функция):**
- Значимые пики на лагах: 1, 3, 4, 5, 7, 8, 9, 11, 12, 16, 20
- Пики на лагах 4, 8, 12 (кратные 4) ярко указывают на СЕЗОННОСТЬ!
- Значение на лаге 1: -0.5068 (значимо) - это большое значение для первого лага
- Заметное значение на лаге 1 указывает на MA(1) компоненту - автокорреляция с прошлыми ошибками
- Медленное затухание сезонных пиков - сезонность сильная и устойчивая

**PACF (Частная автокорреляционная функция):**
- Значимые пики на лагах: 1, 2, 3, 4
- Пики на сезонных лагах (4) подтверждают сезонность
- Не наблюдается резкого обрыва после определённого лага

**Интерпретация для выбора модели:**
- MA(1) компонента нужна (пик на ACF при лаге 1)
- Сезонная компонента с периодом 4 необходима (пики на лагах 4, 8, 12)
- AR компонента не требуется (PACF не обрывается резко после первых лагов)

### 5. Диагностика лучшей модели (tsdiag)

**График 1: Остатки (Residuals)**
- Среднее остатков: 0.003734 (близко к 0) ✓
- Стандартное отклонение: 0.037545
- Остатки выглядят как случайный шум: ДА ✓
- Нет явных трендов или паттернов: ДА ✓
- Колебания остатков выглядят случайными, без систематических отклонений
- Нет видимых аномалий или выбросов

**График 2: ACF остатков**
- Нет значимых пиков: ВСЕ корреляции в пределах доверительных интервалов ✓
- Остатки НЕ коррелируют между собой (хорошо!)
- Все значения ACF находятся в пределах доверительных границ (±0.2 примерно)
- Это идеальный признак белого шума

**График 3: p-values теста Льюнг-Бокса**
- p-value для lag=10: 0.6076
- Остатки - белый шум: ДА ✓ (p > 0.05)
- p-value значительно больше 0.05 - нет оснований отвергать гипотезу о белом шуме
- Все p-values для разных лагов выше 0.05

**Общий вывод диагностики:**
- ✅ МОДЕЛЬ ХОРОШАЯ: остатки похожи на белый шум, нет автокорреляции
- Модель корректно описывает структуру данных
- Нет признаков недоучёта зависимостей или переобучения

### 6. Симуляции AR и MA моделей

**AR модели:**
- p определяет сколько прошлых значений влияет на текущее
- Наблюдение: чем больше p, тем больше значимых пиков в PACF
- AR(1): PACF имеет 1 значимый пик на лаге 1
- AR(2): PACF имеет 2 значимых пика на лагах 1 и 2
- AR(3): PACF имеет 3 значимых пика на лагах 1, 2, 3
- AR(4): PACF имеет 4 значимых пика на лагах 1, 2, 3, 4
- ACF затухает постепенно, PACF обрывается резко

**MA модели:**
- q определяет сколько прошлых ошибок влияет на текущее значение
- Наблюдение: чем больше q, тем больше значимых пиков в ACF
- MA(1): ACF имеет 1 значимый пик на лаге 1
- MA(2): ACF имеет 2 значимых пика на лагах 1 и 2
- MA(3): ACF имеет 3 значимых пика на лагах 1, 2, 3
- MA(4): ACF имеет 4 значимых пика на лагах 1, 2, 3, 4
- ACF обрывается резко, PACF затухает постепенно

**Вывод из симуляций:**
- Это ЗЕРКАЛЬНОЕ поведение AR и MA моделей
- AR модели: PACF обрывается, ACF затухает
- MA модели: ACF обрывается, PACF затухает
- Помогает понять, какой параметр нужен для реальных данных
- Для наших данных (ACF обрывается после лага 1, но есть сезонные пики) нужна MA компонента

## ИТОГОВЫЕ ВЫВОДЫ

### Ключевые находки:

1. **Преобразование данных:**
   - Исходный ряд нестационарный (тренд + гетероскедастичность)
   - Комбинация log + diff эффективно стационаризует ряд
   - Результат: стационарный ряд для моделирования ARIMA
   - Без логарифмирования дисперсия нестабильна

2. **Выбор параметров модели:**
   - d = 1 необходим (убирает тренд)
   - p = 0 оптимально (AR компонента не улучшает модель)
   - q = 1 оптимально (MA(1) критически важна)
   - Сезонные: D = 1, Q = 1, P = 0 (сезонное diff + сезонная MA)
   - Параметры выбраны на основе экспериментов и анализа ACF/PACF

3. **Лучшая модель:**
   - ARIMA(0,1,1)×(0,1,1)[4] с AIC = -282.5299
   - Классическая 'airline model' для сезонных данных
   - Все коэффициенты значимы (|t_value| > 2)
   - Простая и интерпретируемая модель

4. **Качество модели:**
   - Остатки похожи на белый шум ✓
   - Нет автокорреляции в остатках ✓
   - Тест Льюнг-Бокса: p = 0.6076 > 0.05 ✓
   - Модель хорошо описывает структуру данных
   - Нет признаков недоучёта или переобучения

5. **Интерпретация коэффициентов:**
   - ma1 = -0.6809 (отрицательное влияние) - сильная корреляция с прошлыми ошибками
   - sma1 = -0.3146 (отрицательное влияние) - сезонная корреляция с ошибками прошлого года
   - Оба коэффициента значимы и отрицательны, что типично для финансовых данных

### Практические рекомендации:

- Использовать модель ARIMA(0,1,1)×(0,1,1)[4] для прогнозирования EPS Johnson & Johnson
- Модель хорошо обобщается на новые данные (остатки - белый шум)
- Сезонность и краткосрочные зависимости учтены
- Модель интерпретируема и надёжна
- Применение логарифмирования перед моделированием обязательно
- Сезонное дифференцирование критически важно (улучшение AIC на 50+ пунктов)
